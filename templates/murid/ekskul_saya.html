{% extends "murid/layout_murid.html" %}

{% block title %}Ekstrakurikuler Saya{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2>Ekstrakurikuler yang Saya Ikuti</h2>
    <p>Halo, {{ nama_murid }}! Berikut adalah daftar ekstrakurikuler yang sedang atau pernah kamu ikuti.</p>

    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    {% if list_ekskul_diikuti %}
        <div class="table-responsive">
            <table class="table table-hover table-striped">
                <thead class="table-dark">
                    <tr>
                        <th>Nama Ekstrakurikuler</th>
                        <th>Pembina</th>
                        <th>Jadwal</th>
                        <th>Status Pendaftaran</th>
                        <th>Tanggal Daftar</th>
                        <th>Aksi</th> {# <--- KOLOM BARU UNTUK AKSI #}
                    </tr>
                </thead>
                <tbody>
                    {% for item in list_ekskul_diikuti %}
                    <tr>
                        <td>{{ item.nama_ekskul }}</td>
                        <td>{{ item.pembina | default('N/A') }}</td>
                        <td>{{ item.jadwal | default('N/A') }}</td>
                        <td>
                            <span class="badge 
                                {% if item.status_pendaftaran == 'Disetujui' or item.status_pendaftaran == 'Terdaftar' %} bg-success 
                                {% elif item.status_pendaftaran == 'Menunggu Persetujuan' %} bg-warning text-dark
                                {% elif item.status_pendaftaran == 'Ditolak' or item.status_pendaftaran == 'Berhenti' %} bg-danger
                                {% else %} bg-secondary {% endif %}">
                                {{ item.status_pendaftaran }}
                            </span>
                        </td>
                        <td>
                            {% if item.tanggal_pendaftaran %}
                                {{ item.tanggal_pendaftaran.strftime('%d %B %Y, %H:%M') }}
                            {% else %}
                                N/A
                            {% endif %}
                        </td>
                        <td>
                            {# Pastikan item.id_ekskul ada dari app.py #}
                            <a href="{{ url_for('detail_ekskul_murid', ekskul_id=item.id_ekskul) }}" class="btn btn-sm btn-info">
                                <i class="fas fa-eye"></i> Lihat Detail
                            </a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    {% else %}
        <div class="alert alert-info mt-3" role="alert">
            Anda belum terdaftar di ekstrakurikuler manapun pada tahun ajaran ini.
            <a href="{{ url_for('lihat_ekskul_murid') }}" class="alert-link">Lihat daftar ekskul tersedia.</a>
        </div>
    {% endif %}
</div>
{% endblock %}